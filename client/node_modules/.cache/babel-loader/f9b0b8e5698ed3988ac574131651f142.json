{"ast":null,"code":"import _classCallCheck from\"G:\\\\kloud9\\\\dashboard-last\\\\keywords-tool\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"G:\\\\kloud9\\\\dashboard-last\\\\keywords-tool\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"G:\\\\kloud9\\\\dashboard-last\\\\keywords-tool\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"G:\\\\kloud9\\\\dashboard-last\\\\keywords-tool\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"G:\\\\kloud9\\\\dashboard-last\\\\keywords-tool\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";import _inherits from\"G:\\\\kloud9\\\\dashboard-last\\\\keywords-tool\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import React from'react';import Header from\"./components/Header\";import Input from'./components/Input';import KeywordPlot from'./components/plot/index.js';import{appConfig}from'./config.js';import{get_min_value,get_max_value,capitalizeString}from'./components/plot/src/plot/utils/functions';import Loader from\"react-loader-spinner\";import'bootstrap/dist/css/bootstrap.min.css';import'./styles/styles.css';var dimensions=appConfig.dimensions;var MA_Day_5=\"5 Day MA for \";var LOWER_BAND=\"Lower Band for \";var UPPER_BAND=\"Upper Band for \";var ratio=4.5;var SECONDS_NUMBER=60;var App=/*#__PURE__*/function(_React$PureComponent){_inherits(App,_React$PureComponent);function App(props){var _this;_classCallCheck(this,App);_this=_possibleConstructorReturn(this,_getPrototypeOf(App).call(this,props));_this.fetchCallback=function(keywords,selected_state_name,selected_time_frame){_this.setState({displayResults:false,region_state:selected_state_name.toUpperCase()});_this.fetchData(keywords,selected_state_name,selected_time_frame);};_this.errorCallback=function(message){_this.setState({displayError:true,error_message:message});window.setTimeout(function(){_this.setState({displayError:false});},2000);};_this.mapCallback=function(state){_this.setState({displayResults:false,region_state:state.toUpperCase()});_this.fetchData(_this.state.keywords,state,_this.state.selected_time_frame);};_this.handleMouseMove=function(){_this.timer=0;_this.setState({seconds:SECONDS_NUMBER});};_this.updateWindowDimensions=_this.updateWindowDimensions.bind(_assertThisInitialized(_this));_this.handleMouseMove=_this.handleMouseMove.bind(_assertThisInitialized(_this));_this.handleHoverOff=_this.handleHoverOff.bind(_assertThisInitialized(_this));_this.timer=0;_this.startTimer=_this.startTimer.bind(_assertThisInitialized(_this));_this.countDown=_this.countDown.bind(_assertThisInitialized(_this));_this.state={username:\"user\",displayResults:false,fetching_results:false,displayError:false,region_state:\"US\",selected_time_frame:\"today 5-y\",keywords:[],data:[],error_message:\"\",time:{},seconds:SECONDS_NUMBER};_this.myRef=React.createRef();return _this;}_createClass(App,[{key:\"fetchData\",value:function fetchData(keywords,state,selected_time_frame){var _this2=this;var url=\"/data\";// let url = appConfig.KEYWORDS_DATA2\nthis.setState({fetching_results:true,keywords:keywords});fetch(url,{method:'POST',headers:{'Content-type':'application/json'},body:JSON.stringify({keywords:keywords,region_state:state,time_frame:selected_time_frame})}).then(function(res){return res.json();}).then(function(result){var width=_this2.myRef.current.offsetWidth;var sizes=_this2.get_dimensions(width);_this2.setState({keywords:keywords,displayResults:true,fetching_results:false,region_state:state.toUpperCase(),selected_time_frame:selected_time_frame,data:_this2.get_data2(keywords,result),div_height:sizes.height,width:width});}).catch(function(error){console.log(error);});}},{key:\"componentDidMount\",value:function componentDidMount(){this.updateWindowDimensions();window.addEventListener('resize',this.updateWindowDimensions);this.myRef.current.focus();var timeLeftVar=this.secondsToTime(this.state.seconds);this.setState({time:timeLeftVar});}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){window.removeEventListener('resize',this.updateWindowDimensions);}},{key:\"updateWindowDimensions\",value:function updateWindowDimensions(){var width=this.myRef.current.offsetWidth;var sizes=this.get_dimensions(width);this.setState({div_height:sizes.height,width:width});}},{key:\"render\",value:function render(){var plot_settings={title:\"Trends Forecast\",x_label:\"Date\",y_label:\"Search interest (%)\",number_of_series:this.state.keywords.length,keywords:this.state.keywords,height:this.state.div_height,width:this.state.width};return React.createElement(\"div\",{ref:this.myRef,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleHoverOff},React.createElement(\"div\",{className:\"main_results\"},React.createElement(Header,{username:this.state.username}),React.createElement(Input,{callbackFromParent:this.fetchCallback,errorTimeframeCallback:this.errorCallback}),this.state.displayError?React.createElement(\"div\",{className:\"error_message\"},this.state.error_message):React.createElement(\"div\",null,React.createElement(\"br\",null)),this.state.displayResults?React.createElement(\"div\",{className:\"content\"},React.createElement(\"div\",{className:\"results_div\"},React.createElement(KeywordPlot,{plot_settings:plot_settings,data:this.state.data}))):React.createElement(\"div\",null,this.state.fetching_results?React.createElement(\"div\",{className:\"spinner\"},React.createElement(Loader,{type:\"Oval\",color:\"#1694d0\",height:200,width:200,timeout:30000})):React.createElement(\"div\",null))));}},{key:\"get_data\",value:function get_data(keywords,result){var historical_data=[];var forecasted_data=[];var _loop=function _loop(keyword){var index=0;var k_w=keywords[keyword];var length=Object.keys(result[k_w]).length-60;console.log(Object.keys(result[k_w]).length);var arr=Object.keys(result[k_w]).map(function(key){if(result[k_w][key]!==null){if(index<4){return[index++,new Date(key).valueOf(),result[k_w][key],result[LOWER_BAND+k_w][key],result[UPPER_BAND+k_w][key]];}else{return[index++,new Date(key).valueOf(),result[MA_Day_5+k_w][key],result[LOWER_BAND+k_w][key],result[UPPER_BAND+k_w][key]];}}});historical_data.push(arr.slice(0,index));arr=Object.keys(result[keywords[keyword]+\"F\"]).map(function(key){if(index<4){return[index++,new Date(key).valueOf(),result[keywords[keyword]+\"F\"][key],result[LOWER_BAND+k_w+\"F\"][key],result[UPPER_BAND+k_w+\"F\"][key]];}else{return[index++,new Date(key).valueOf(),result[MA_Day_5+k_w+\"F\"][key],result[LOWER_BAND+k_w+\"F\"][key],result[UPPER_BAND+k_w+\"F\"][key]];}});forecasted_data.push(arr.slice(length,length+52));};for(var keyword in keywords){_loop(keyword);}return{historical_data:historical_data,forecasted_data:forecasted_data};}},{key:\"get_data2\",value:function get_data2(keywords,result){var historical_data=[];var forecasted_data=[];var _loop2=function _loop2(keyword){var index=0;var k_w=keywords[keyword];var length=Object.keys(result.historical_data).length;var arr=Object.keys(result.historical_data).map(function(key){if(result.historical_data[key]!==null){if(index<4){return[index++,new Date(key).valueOf(),result.historical_data[key][k_w].value,result.historical_data[key][k_w].L_B,result.historical_data[key][k_w].U_B];}else{return[index++,new Date(key).valueOf(),result.historical_data[key][k_w].M_A,result.historical_data[key][k_w].L_B,result.historical_data[key][k_w].U_B];}}});historical_data.push(arr.slice(0,index));arr=Object.keys(result.forecasted_data).map(function(key){if(index<4){return[index++,new Date(key).valueOf(),result.forecasted_data[key][k_w].value,result.forecasted_data[key][k_w].L_B,result.forecasted_data[key][k_w].U_B];}else{return[index++,new Date(key).valueOf(),result.forecasted_data[key][k_w].M_A,result.forecasted_data[key][k_w].L_B,result.forecasted_data[key][k_w].U_B];}});forecasted_data.push(arr.slice(length,length+52));};for(var keyword in keywords){_loop2(keyword);}return{historical_data:historical_data,forecasted_data:forecasted_data};}},{key:\"get_dimensions\",value:function get_dimensions(width){var height=width/ratio;if(width>1800){height=height;}if(width<=1800){height=1.2*width/ratio;}if(width<=1600){height=1.4*width/ratio;}if(width<=1400){height=1.7*width/ratio;}if(width<=1200){height=2.2*width/ratio;}if(width<=700){height=3.4*width/ratio;}var sizes={height:height};return sizes;}}]);return App;}(React.PureComponent);export default App;","map":{"version":3,"sources":["G:/kloud9/dashboard-last/keywords-tool/client/src/App.js"],"names":["React","Header","Input","KeywordPlot","appConfig","get_min_value","get_max_value","capitalizeString","Loader","dimensions","MA_Day_5","LOWER_BAND","UPPER_BAND","ratio","SECONDS_NUMBER","App","props","fetchCallback","keywords","selected_state_name","selected_time_frame","setState","displayResults","region_state","toUpperCase","fetchData","errorCallback","message","displayError","error_message","window","setTimeout","mapCallback","state","handleMouseMove","timer","seconds","updateWindowDimensions","bind","handleHoverOff","startTimer","countDown","username","fetching_results","data","time","myRef","createRef","url","fetch","method","headers","body","JSON","stringify","time_frame","then","res","json","result","width","current","offsetWidth","sizes","get_dimensions","get_data2","div_height","height","catch","error","console","log","addEventListener","focus","timeLeftVar","secondsToTime","removeEventListener","plot_settings","title","x_label","y_label","number_of_series","length","historical_data","forecasted_data","keyword","index","k_w","Object","keys","arr","map","key","Date","valueOf","push","slice","value","L_B","U_B","M_A","PureComponent"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport Header from \"./components/Header\"\r\nimport Input from './components/Input'\r\n\r\nimport KeywordPlot from './components/plot/index.js';\r\nimport { appConfig } from './config.js';\r\nimport { get_min_value, get_max_value, capitalizeString } from './components/plot/src/plot/utils/functions';\r\n\r\nimport Loader from \"react-loader-spinner\";\r\nimport 'bootstrap/dist/css/bootstrap.min.css';\r\nimport './styles/styles.css';\r\n\r\nlet dimensions = appConfig.dimensions;\r\n\r\nconst MA_Day_5 = \"5 Day MA for \";\r\nconst LOWER_BAND = \"Lower Band for \";\r\nconst UPPER_BAND = \"Upper Band for \";\r\n\r\n\r\nconst ratio = 4.5;\r\n\r\nconst SECONDS_NUMBER = 60;\r\n\r\nclass App extends React.PureComponent {\r\n  \r\n    constructor(props){\r\n      super(props);\r\n      this.updateWindowDimensions = this.updateWindowDimensions.bind(this);\r\n      this.handleMouseMove = this.handleMouseMove.bind(this);\r\n      this.handleHoverOff = this.handleHoverOff.bind(this);\r\n\r\n      this.timer = 0;\r\n      this.startTimer = this.startTimer.bind(this);\r\n      this.countDown = this.countDown.bind(this);\r\n\r\n      this.state = {\r\n        username: \"user\",\r\n        displayResults: false,\r\n        fetching_results: false,\r\n        displayError: false,\r\n\r\n        region_state: \"US\",\r\n        selected_time_frame: \"today 5-y\",\r\n        keywords: [],\r\n        data: [],\r\n\r\n        \r\n        error_message: \"\",\r\n        \r\n        time: {},\r\n        seconds: SECONDS_NUMBER,\r\n      };\r\n\r\n      this.myRef = React.createRef();\r\n\r\n    }\r\n\r\n    fetchCallback = (keywords, selected_state_name, selected_time_frame) => {\r\n      this.setState({\r\n          displayResults: false,\r\n          region_state: selected_state_name.toUpperCase(),\r\n      });\r\n\r\n      this.fetchData(keywords, selected_state_name, selected_time_frame)\r\n    }\r\n\r\n    errorCallback = (message) => {\r\n\r\n      this.setState({\r\n        displayError: true,\r\n        error_message: message,\r\n      });\r\n\r\n      window.setTimeout(() => {\r\n        this.setState({\r\n          displayError: false\r\n        });\r\n      }, 2000);\r\n\r\n    }\r\n\r\n    mapCallback = (state) => {\r\n\r\n      this.setState({\r\n        displayResults: false,\r\n        region_state: state.toUpperCase(),\r\n      });\r\n\r\n      this.fetchData(this.state.keywords, state, this.state.selected_time_frame)\r\n    }\r\n\r\n    fetchData(keywords, state, selected_time_frame){\r\n\r\n      let url = \"/data\"\r\n      // let url = appConfig.KEYWORDS_DATA2\r\n\r\n      this.setState({\r\n        fetching_results: true,\r\n        keywords: keywords\r\n      })\r\n\r\n      fetch(url, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-type':'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          keywords: keywords, region_state: state, time_frame: selected_time_frame\r\n        }),\r\n      }).then(res => res.json())\r\n        .then(\r\n        (result) => {\r\n          let width = this.myRef.current.offsetWidth;\r\n          let sizes = this.get_dimensions(width);\r\n\r\n          this.setState({\r\n            keywords: keywords,\r\n            displayResults: true,\r\n            fetching_results: false,\r\n\r\n            region_state: state.toUpperCase(),\r\n            selected_time_frame: selected_time_frame,\r\n\r\n            data: this.get_data2(keywords, result),\r\n            \r\n            div_height: sizes.height,\r\n            width: width,\r\n          });\r\n        }).catch(function(error) {\r\n        console.log(error)\r\n        })\r\n      }\r\n\r\n    componentDidMount() {\r\n      this.updateWindowDimensions();\r\n      window.addEventListener('resize', this.updateWindowDimensions);\r\n      this.myRef.current.focus();\r\n\r\n      let timeLeftVar = this.secondsToTime(this.state.seconds);\r\n      this.setState({ time: timeLeftVar });\r\n\r\n    }\r\n\r\n    componentWillUnmount() {\r\n      window.removeEventListener('resize', this.updateWindowDimensions);\r\n    }\r\n   \r\n    updateWindowDimensions() {\r\n      let width = this.myRef.current.offsetWidth;\r\n      let sizes = this.get_dimensions(width);\r\n\r\n      this.setState({\r\n        div_height: sizes.height,\r\n        width: width,\r\n      });\r\n    }\r\n\r\n\r\n    handleMouseMove= () => {\r\n      this.timer = 0;\r\n      this.setState({\r\n        seconds: SECONDS_NUMBER,\r\n      });\r\n    }\r\n\r\n    render() {\r\n\r\n      let plot_settings = {\r\n        title: \"Trends Forecast\",\r\n        x_label: \"Date\",\r\n        y_label: \"Search interest (%)\",\r\n\r\n        number_of_series: this.state.keywords.length,\r\n        keywords: this.state.keywords,\r\n\r\n        height: this.state.div_height,\r\n        width: this.state.width\r\n\r\n      }\r\n\r\n        return (\r\n          <div ref={this.myRef} onMouseMove={this.handleMouseMove} onMouseLeave={this.handleHoverOff}>\r\n            \r\n            <div className=\"main_results\">\r\n              <Header username={this.state.username} />\r\n              <Input callbackFromParent={this.fetchCallback} errorTimeframeCallback={this.errorCallback} />\r\n\r\n              { (this.state.displayError) ? (<div className=\"error_message\">{this.state.error_message}</div>) : (<div><br/></div>)}\r\n\r\n            { (this.state.displayResults) ? (\r\n            \r\n            <div className=\"content\">\r\n              <div className=\"results_div\">\r\n\r\n                {/* <div id=\"plot_div\">  */}\r\n                  <KeywordPlot plot_settings={plot_settings} data={this.state.data} />\r\n                {/* </div> */}\r\n              </div>\r\n\r\n            </div>  ) : (\r\n            \r\n            <div>\r\n              {/* <div className=\"intro\">\r\n\r\n              </div> */}\r\n              {this.state.fetching_results ? (    \r\n                <div className=\"spinner\">\r\n                  <Loader type=\"Oval\" color=\"#1694d0\" height={200} width={200} timeout={30000} />\r\n                </div>   \r\n                ) : (<div></div>) }\r\n            </div>\r\n            )\r\n          }\r\n\r\n          </div>\r\n        </div>\r\n      );\r\n      \r\n    }\r\n    \r\n      get_data(keywords, result) {\r\n        let historical_data = []\r\n        let forecasted_data = []\r\n\r\n        for (let keyword in keywords) {  \r\n          let index = 0;\r\n          let k_w = keywords[keyword]\r\n          let length = Object.keys(result[k_w]).length - 60;\r\n          console.log(Object.keys(result[k_w]).length)\r\n          \r\n          let arr = Object.keys(result[k_w]).map(\r\n            function(key) {\r\n              if(result[k_w][key] !== null){\r\n                if (index < 4) {\r\n                  return [index++, new Date(key).valueOf(), result[k_w][key], result[LOWER_BAND+k_w][key], result[UPPER_BAND+k_w][key]]\r\n                } else {\r\n                  return [index++, new Date(key).valueOf(), result[MA_Day_5+k_w][key], result[LOWER_BAND+k_w][key], result[UPPER_BAND+k_w][key]]\r\n                }\r\n              } \r\n            }\r\n          );\r\n\r\n          historical_data.push(arr.slice(0, index))\r\n\r\n          arr = Object.keys(result[keywords[keyword] + \"F\"]).map(\r\n            function(key) {\r\n              if (index < 4) {\r\n                return [index++, new Date(key).valueOf(), result[keywords[keyword] + \"F\"][key], result[LOWER_BAND+k_w+ \"F\"][key], result[UPPER_BAND + k_w + \"F\"][key]]            \r\n              } else {\r\n                return [index++, new Date(key).valueOf(), result[MA_Day_5 + k_w + \"F\"][key], result[LOWER_BAND + k_w + \"F\"][key], result[UPPER_BAND + k_w + \"F\"][key]]\r\n              }\r\n            }\r\n          );\r\n\r\n          forecasted_data.push(arr.slice(length, length + 52))\r\n        }\r\n\r\n        return {\r\n          historical_data: historical_data,\r\n          forecasted_data: forecasted_data\r\n        }\r\n\r\n      }\r\n\r\n      get_data2(keywords, result) {\r\n        let historical_data = []\r\n        let forecasted_data = []\r\n\r\n        for (let keyword in keywords) {  \r\n          let index = 0;\r\n          let k_w = keywords[keyword]\r\n          let length = Object.keys(result.historical_data).length\r\n\r\n          \r\n          let arr = Object.keys(result.historical_data).map(\r\n            function(key) {\r\n              if(result.historical_data[key] !== null){\r\n                if (index < 4) {\r\n                  return [index++, new Date(key).valueOf(), result.historical_data[key][k_w].value, result.historical_data[key][k_w].L_B, result.historical_data[key][k_w].U_B]\r\n                } else {\r\n                  return [index++, new Date(key).valueOf(), result.historical_data[key][k_w].M_A, result.historical_data[key][k_w].L_B, result.historical_data[key][k_w].U_B]\r\n                }\r\n              } \r\n            }\r\n          );\r\n  \r\n          historical_data.push(arr.slice(0, index))\r\n  \r\n          arr = Object.keys(result.forecasted_data).map(\r\n            function(key) {\r\n              if (index < 4) {\r\n                return [index++, new Date(key).valueOf(), result.forecasted_data[key][k_w].value, result.forecasted_data[key][k_w].L_B, result.forecasted_data[key][k_w].U_B]\r\n              } else {\r\n                return [index++, new Date(key).valueOf(), result.forecasted_data[key][k_w].M_A, result.forecasted_data[key][k_w].L_B, result.forecasted_data[key][k_w].U_B]\r\n              }\r\n            }\r\n          );\r\n  \r\n          forecasted_data.push(arr.slice(length, length + 52))\r\n        }\r\n\r\n        return {\r\n          historical_data: historical_data,\r\n          forecasted_data: forecasted_data\r\n        }\r\n  \r\n      }\r\n\r\n  get_dimensions(width) {\r\n    let height = width/(ratio);\r\n\r\n    if (width>1800) {\r\n      height = height;\r\n    }\r\n\r\n    if (width<=1800) {\r\n      height = (1.2)*width/(ratio);\r\n    }\r\n\r\n    if (width<=1600) {\r\n      height = (1.4)*width/(ratio);\r\n    }\r\n    \r\n    if (width<=1400) {\r\n      height = (1.7)*width/(ratio);\r\n    }\r\n\r\n    if (width<=1200) {\r\n      height = (2.2)*width/(ratio);\r\n    }\r\n\r\n    if (width<=700) {\r\n      height = (3.4)*width/(ratio);\r\n    }\r\n\r\n    let sizes = {\r\n      height: height,\r\n    }\r\n\r\n    return sizes;\r\n  }\r\n}\r\n  \r\n  \r\nexport default App;\r\n"]},"metadata":{},"sourceType":"module"}